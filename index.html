<!DOCTYPE html>

<html lang="en">

<head>

  <meta charset="UTF-8">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Advanced Wing Aerodynamics ML Predictor</title>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/tensorflow/4.10.0/tf.min.js"></script>

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      background: rgba(255, 255, 255, 0.95);
      border-radius: 20px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
      overflow: hidden;
    }

    .header {
      background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
      color: white;
      text-align: center;
      padding: 30px;
    }

    .header h1 {
      font-size: 2.5em;
      margin-bottom: 10px;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
    }

    .header p {
      font-size: 1.2em;
      opacity: 0.9;
    }

    .content {
      padding: 30px;
    }

    .control-panel {
      background: #f8f9fa;
      border-radius: 15px;
      padding: 25px;
      margin-bottom: 30px;
      border: 2px solid #e9ecef;
    }

    .control-panel h3 {
      color: #2c3e50;
      margin-bottom: 20px;
      font-size: 1.4em;
      border-bottom: 2px solid #3498db;
      padding-bottom: 10px;
    }

    .controls-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
      margin-bottom: 20px;
    }

    .control-group {
      background: white;
      padding: 15px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .control-group label {
      display: block;
      font-weight: 600;
      color: #34495e;
      margin-bottom: 8px;
    }

    .control-group input,
    .control-group select {
      width: 100%;
      padding: 10px;
      border: 2px solid #ddd;
      border-radius: 5px;
      font-size: 14px;
      transition: border-color 0.3s;
    }

    .control-group input:focus,
    .control-group select:focus {
      outline: none;
      border-color: #3498db;
    }

    .control-group small {
      color: #7f8c8d;
      font-size: 0.9em;
    }

    .button-group {
      display: flex;
      gap: 15px;
      justify-content: center;
      flex-wrap: wrap;
      margin: 20px 0;
    }

    .btn {
      padding: 12px 25px;
      border: none;
      border-radius: 25px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 600;
      transition: all 0.3s;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .btn-primary {
      background: linear-gradient(135deg, #3498db, #2980b9);
      color: white;
    }

    .btn-secondary {
      background: linear-gradient(135deg, #95a5a6, #7f8c8d);
      color: white;
    }

    .btn-success {
      background: linear-gradient(135deg, #27ae60, #2ecc71);
      color: white;
    }

    .btn-warning {
      background: linear-gradient(135deg, #f39c12, #e67e22);
      color: white;
    }

    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    .results {
      background: #f8f9fa;
      border-radius: 15px;
      padding: 25px;
      margin: 20px 0;
      border-left: 5px solid #27ae60;
    }

    .results h3 {
      color: #27ae60;
      margin-bottom: 15px;
      font-size: 1.4em;
    }

    .prediction-results {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin: 20px 0;
    }

    .prediction-result {
      background: linear-gradient(135deg, #27ae60, #2ecc71);
      color: white;
      padding: 20px;
      border-radius: 10px;
      text-align: center;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }

    .prediction-result.drag {
      background: linear-gradient(135deg, #e74c3c, #c0392b);
    }

    .prediction-result h4 {
      font-size: 1.3em;
      margin-bottom: 10px;
    }

    .prediction-value {
      font-size: 2.2em;
      font-weight: bold;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
    }

    .charts-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
      gap: 30px;
      margin: 30px 0;
    }

    .chart-container {
      background: white;
      border-radius: 15px;
      padding: 20px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      height: 400px;
    }

    .chart-container canvas {
      max-height: 350px !important;
    }

    .chart-container h4 {
      color: #2c3e50;
      margin-bottom: 15px;
      text-align: center;
      font-size: 1.2em;
    }

    .simulation-container {
      background: #2c3e50;
      border-radius: 15px;
      padding: 20px;
      margin: 20px 0;
      color: white;
      position: relative;
      height: 400px;
      overflow: hidden;
    }

    .simulation-canvas {
      width: 100%;
      height: 100%;
      border-radius: 10px;
      background: linear-gradient(135deg, #34495e, #2c3e50);
    }

    .status {
      background: #e8f4f8;
      border-left: 4px solid #3498db;
      padding: 15px;
      margin: 15px 0;
      border-radius: 0 10px 10px 0;
    }

    .loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid #f3f3f3;
      border-top: 3px solid #3498db;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-right: 10px;
    }

    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }

    .model-info {
      background: #fff3cd;
      border: 1px solid #ffeaa7;
      color: #856404;
      padding: 15px;
      border-radius: 10px;
      margin: 20px 0;
    }

    .airfoil-preview {
      background: white;
      border-radius: 10px;
      padding: 20px;
      margin: 20px 0;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .airfoil-shape {
      width: 100%;
      height: 100px;
      background: #ecf0f1;
      border-radius: 5px;
      position: relative;
      overflow: hidden;
    }

    .airfoil-svg {
      width: 100%;
      height: 100%;
    }

    .training-progress {
      background: white;
      border-radius: 10px;
      padding: 20px;
      margin: 20px 0;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .progress-bar {
      width: 100%;
      height: 20px;
      background: #ecf0f1;
      border-radius: 10px;
      overflow: hidden;
      margin: 10px 0;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(135deg, #3498db, #2980b9);
      width: 0%;
      transition: width 0.3s;
    }

    .example-airfoils {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin: 20px 0;
    }

    .example-airfoil {
      background: white;
      border: 2px solid #e9ecef;
      border-radius: 10px;
      padding: 15px;
      cursor: pointer;
      transition: all 0.3s;
      text-align: center;
    }

    .example-airfoil:hover {
      border-color: #3498db;
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }

    .example-airfoil h5 {
      color: #2c3e50;
      margin-bottom: 10px;
      font-size: 1.1em;
    }

    .airfoil-code {
      font-family: 'Courier New', monospace;
      font-weight: bold;
      color: #e74c3c;
    }
  </style>

</head>

<body>

  <div class="container">

    <div class="header">

      <h1>✈️ Advanced Wing Aerodynamics ML Predictor</h1>

      <p>Predict lift & drag with TensorFlow.js • NACA airfoils • Real-time simulations</p>

    </div>

    <div class="content">

      <div class="control-panel">

        <h3>Wing Configuration Parameters</h3>

        <div class="controls-grid">

          <div class="control-group">

            <label for="nacaCode">NACA Airfoil Code</label>

            <select id="nacaCode">

              <option value="0012">NACA 0012 (Symmetric)</option>

              <option value="2412">NACA 2412 (Cambered)</option>

              <option value="4412">NACA 4412 (High Camber)</option>

              <option value="6412">NACA 6412 (Very High Camber)</option>

              <option value="0018">NACA 0018 (Thick Symmetric)</option>

              <option value="2415">NACA 2415 (Thick Cambered)</option>

              <option value="23012">NACA 23012 (5-digit)</option>

              <option value="64212">NACA 64-212 (Laminar Flow)</option>

            </select>

            <small>Select standard NACA airfoil profile</small>

          </div>

          <div class="control-group">

            <label for="angleOfAttack">Angle of Attack (degrees)</label>

            <input type="number" id="angleOfAttack" value="5" min="-15" max="25" step="0.1">

            <small>Typical range: -15° to 25°</small>

          </div>

          <div class="control-group">

            <label for="wingSpan">Wing Span (meters)</label>

            <input type="number" id="wingSpan" value="10" min="5" max="25" step="0.1">

            <small>Distance from tip to tip</small>

          </div>

          <div class="control-group">

            <label for="chordLength">Chord Length (meters)</label>

            <input type="number" id="chordLength" value="2" min="1" max="5" step="0.1">

            <small>Wing depth from front to back</small>

          </div>

          <div class="control-group">

            <label for="airspeed">Airspeed (m/s)</label>

            <input type="number" id="airspeed" value="80" min="20" max="350" step="1">

            <small>Aircraft velocity</small>

          </div>

          <div class="control-group">

            <label for="reynolds">Reynolds Number</label>

            <input type="number" id="reynolds" value="1000000" min="100000" max="10000000" step="10000">

            <small>Flow regime indicator</small>

          </div>

        </div>

        <div class="button-group">

          <button class="btn btn-primary" onclick="predictCoefficients()">🎯 Predict CL & CD</button>

          <button class="btn btn-secondary" onclick="generateAdvancedData()">📊 Generate Data</button>

          <button class="btn btn-success" onclick="trainNeuralNetwork()">🧠 Train Neural Net</button>

          <button class="btn btn-warning" onclick="startFlowSimulation()">🌊 Flow Simulation</button>

        </div>

      </div>

      <div class="airfoil-preview">

        <h4>Airfoil Profile Preview</h4>

        <div class="airfoil-shape">

          <svg class="airfoil-svg" id="airfoilSvg" viewBox="0 0 400 100">

            <!-- Airfoil shape will be drawn here -->

          </svg>

        </div>

        <div id="airfoilInfo" style="margin-top: 10px; color: #7f8c8d;">

          Select an airfoil to see its profile and characteristics

        </div>

      </div>

      <div class="example-airfoils">

        <div class="example-airfoil" onclick="loadExampleAirfoil('0012')">

          <h5>Symmetric</h5>

          <div class="airfoil-code">NACA 0012</div>

          <small>No camber, 12% thick</small>

        </div>

        <div class="example-airfoil" onclick="loadExampleAirfoil('2412')">

          <h5>General Aviation</h5>

          <div class="airfoil-code">NACA 2412</div>

          <small>2% camber, 12% thick</small>

        </div>

        <div class="example-airfoil" onclick="loadExampleAirfoil('4412')">

          <h5>High Lift</h5>

          <div class="airfoil-code">NACA 4412</div>

          <small>4% camber, 12% thick</small>

        </div>

        <div class="example-airfoil" onclick="loadExampleAirfoil('64212')">

          <h5>Laminar Flow</h5>

          <div class="airfoil-code">NACA 64-212</div>

          <small>Low drag design</small>

        </div>

      </div>

      <div class="model-info">

        <h4>🧠 Neural Network Status</h4>

        <div id="modelStatus">Ready to train TensorFlow.js neural network for advanced predictions!</div>

        <div class="training-progress" id="trainingProgress" style="display: none;">

          <h5>Training Progress</h5>

          <div class="progress-bar">

            <div class="progress-fill" id="progressFill"></div>

          </div>

          <div id="trainingMetrics"></div>

        </div>

      </div>

      <div class="simulation-container">

        <h4 style="text-align: center; margin-bottom: 15px;">🌊 Airflow Simulation</h4>

        <canvas class="simulation-canvas" id="flowCanvas" width="800" height="300"></canvas>

        <div style="position: absolute; bottom: 10px; left: 20px; font-size: 0.9em;">

          Click "Flow Simulation" to see particle flow visualization

        </div>

      </div>

      <div id="results" class="results" style="display: none;">

        <h3>🎯 Prediction Results</h3>

        <div class="prediction-results" id="predictionOutput"></div>

        <div id="theoreticalComparison"></div>

      </div>

      <div class="charts-container">

        <div class="chart-container">

          <h4>📈 Lift vs Angle of Attack</h4>

          <canvas id="liftChart"></canvas>

        </div>

        <div class="chart-container">

          <h4>📊 Drag Polar Curve</h4>

          <canvas id="dragChart"></canvas>

        </div>

        <div class="chart-container">

          <h4>🎯 ML vs Theoretical</h4>

          <canvas id="comparisonChart"></canvas>

        </div>

        <div class="chart-container">

          <h4>🧠 Training Loss</h4>

          <canvas id="lossChart"></canvas>

        </div>

      </div>

    </div>

  </div>

  <script>
    // Global variables
    let trainingData = [];
    let neuralNetwork = null;
    let scaler = null;
    let isTraining = false;
    let flowSimulation = null;
    // Chart storage
    window.liftChart = null;
    window.dragChart = null;
    window.comparisonChart = null;
    window.lossChart = null;
    // NACA Airfoil database with characteristics
    const nacaDatabase = {
      '0012': {
        camber: 0,
        position: 0,
        thickness: 12,
        clMax: 1.2,
        clSlope: 6.28,
        cd0: 0.008,
        description: 'Symmetric, good for aerobatics'
      },
      '2412': {
        camber: 2,
        position: 40,
        thickness: 12,
        clMax: 1.4,
        clSlope: 6.5,
        cd0: 0.009,
        description: 'Popular general aviation airfoil'
      },
      '4412': {
        camber: 4,
        position: 40,
        thickness: 12,
        clMax: 1.6,
        clSlope: 6.8,
        cd0: 0.011,
        description: 'High-lift, good for slow flight'
      },
      '6412': {
        camber: 6,
        position: 40,
        thickness: 12,
        clMax: 1.8,
        clSlope: 7.0,
        cd0: 0.014,
        description: 'Very high camber, high CL'
      },
      '0018': {
        camber: 0,
        position: 0,
        thickness: 18,
        clMax: 1.3,
        clSlope: 6.0,
        cd0: 0.012,
        description: 'Thick symmetric, structural'
      },
      '2415': {
        camber: 2,
        position: 40,
        thickness: 15,
        clMax: 1.5,
        clSlope: 6.3,
        cd0: 0.012,
        description: 'Thick cambered, good structure'
      },
      '23012': {
        camber: 2.3,
        position: 15,
        thickness: 12,
        clMax: 1.35,
        clSlope: 6.4,
        cd0: 0.0085,
        description: '5-digit series, refined design'
      },
      '64212': {
        camber: 2,
        position: 40,
        thickness: 12,
        clMax: 1.3,
        clSlope: 6.6,
        cd0: 0.006,
        description: 'Laminar flow, low drag'
      }
    };
    // Simple StandardScaler
    class AdvancedScaler {
      constructor() {
        this.means = [];
        this.stds = [];
      }
      fit(X) {
        const nFeatures = X[0].length;
        this.means = new Array(nFeatures).fill(0);
        this.stds = new Array(nFeatures).fill(0);
        for (let i = 0; i < nFeatures; i++) {
          const values = X.map(row => row[i]);
          this.means[i] = values.reduce((a, b) => a + b) / values.length;
        }
        for (let i = 0; i < nFeatures; i++) {
          const values = X.map(row => row[i]);
          const variance = values.reduce((sum, val) => sum + Math.pow(val - this.means[i], 2), 0) / values.length;
          this.stds[i] = Math.sqrt(variance) || 1;
        }
      }
      transform(X) {
        return X.map(row =>
          row.map((val, i) => (val - this.means[i]) / this.stds[i])
        );
      }
    }
    // Generate NACA airfoil coordinates
    function generateNacaCoordinates(naca, numPoints = 50) {
      const coordinates = [];
      if (naca.length === 4) {
        // 4-digit NACA
        const m = parseInt(naca[0]) / 100; // max camber
        const p = parseInt(naca[1]) / 10; // position of max camber
        const t = parseInt(naca.substr(2)) / 100; // thickness
        for (let i = 0; i < numPoints; i++) {
          const x = i / (numPoints - 1);
          // Thickness distribution
          const yt = 5 * t * (0.2969 * Math.